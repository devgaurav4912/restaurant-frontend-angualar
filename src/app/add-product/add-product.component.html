

<div class="row">
  <div class="col-md-5">
    <div class="container form-container">
      <h1 class="heading text-center">Add Product</h1>
      <form id="settingsForm" [formGroup]="addProductForm" (ngSubmit)="postProduct()">
        <!-- Product Name -->
        <div class="mt-1 mb-1">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Product Name</mat-label>
            <input matInput formControlName="productName" placeholder="Enter Product Name">
            <mat-error *ngIf="addProductForm.get('productName')!.invalid && addProductForm.get('productName')!.touched">
              Product Name is required!!
            </mat-error>
          </mat-form-field>
        </div>
    
        <br />
    
        <!-- Product Image (Standard HTML file input) -->
        <div class="mt-1 mb-0">
          <label for="productImage" class="form-label">Product Image</label>
          <input type="file" #fileInput (change)="onFileChange($event)" class="form-control">
          <mat-error *ngIf="addProductForm.get('productImage')!.invalid && addProductForm.get('productImage')!.touched">
            Image is required!!
          </mat-error>
    
          <!-- Display existing image if available -->
          <div class="text-center mt-2" *ngIf="productImageUrl">
            <img class="product-image-url" [src]="productImageUrl" alt="Product Image" width="100" />
          </div>
        </div>
    
        <br />
    
        <!-- Product Price -->
        <div class="mt-0 mb-1">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Product Price</mat-label>
            <input matInput formControlName="productPrice" type="number" placeholder="Enter Product Price" min="0">
            <mat-error *ngIf="addProductForm.get('productPrice')!.invalid && addProductForm.get('productPrice')!.touched">
              Product price required!!
            </mat-error>
          </mat-form-field>
        </div>
    
        <br />
    
        <!-- Select Category -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Select Category</mat-label>
          <mat-select formControlName="categoryName">
            <mat-option *ngFor="let category of categories" [value]="category.categoryName">
              {{category.categoryName}}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="addProductForm.get('categoryName')!.invalid && addProductForm.get('categoryName')!.touched">
            Please select a category.
          </mat-error>
        </mat-form-field>
    
        <br />
    
        <!-- Submit Button -->
        <button  mat-raised-button color="primary" type="submit" class="submit-button full-width">
          Submit
        </button>
      </form>
    </div>
    
    
  </div>
  <div class="col-md-7">
    <div class="product-list-container">
  <div class="search-bar">
    <mat-form-field appearance="fill">
      <mat-label>Search Products</mat-label>
      <input matInput placeholder="Type to search..." (input)="applyFilter($event)">
      <button mat-button *ngIf="searchText" matSuffix mat-icon-button aria-label="Clear" (click)="searchText=''">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
  </div>

  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

    <!-- Product Name Column -->
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef> Product Name </th>
      <td mat-cell *matCellDef="let product"> {{product.productName}} </td>
    </ng-container>

    <!-- Image Column -->
    <ng-container matColumnDef="image">
      <th mat-header-cell *matHeaderCellDef> Image </th>
      <td mat-cell *matCellDef="let product">
        <img [src]="product.productImage" alt="{{product.productName}}" class="product-image">
      </td>
    </ng-container>

    <!-- Product Price Column -->
    <ng-container matColumnDef="price">
      <th mat-header-cell *matHeaderCellDef> Price (₹) </th>
      <td mat-cell *matCellDef="let product"> ₹{{product.productPrice}} </td>
    </ng-container>

    <!-- Action Column -->
    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef> Action </th>
      <td mat-cell *matCellDef="let product">
        <button class="btn btn-primary btn-sm me-2" (click)="onUpdate(product.productId)">
          <i class="far fa-edit"></i>
        </button>
        <button class="btn btn-danger btn-sm" (click)="deleteProduct(product.productId)">
          <i class="far fa-trash-alt"></i>
        </button>
      </td>        
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" [length]="dataSource.data.length"></mat-paginator>
</div>
    
  </div>
</div>
